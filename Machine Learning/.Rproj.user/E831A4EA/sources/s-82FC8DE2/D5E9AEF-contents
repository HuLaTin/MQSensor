#transpose events dataframe
events <- as.data.frame(t(events))

#set seed so events are reproducible
set.seed(2345)

#clusters <- kmeans(events[], k)
clusters <- kmeans(events[], 7)

#data points in each group
clusters$size

events$cluster <- clusters$cluster
table(events$cluster)

#(?)
events.feature = as.matrix(events)

#graph cluster (?)
#events$cluster <- as.factor(events$cluster)


#Dendrogram
hc <- hclust(dist(events.feature), "ave")
plot(hc, hang = -1)

#Heatmap
library(gplots)
library(RColorBrewer )
#my_palette <- colorRampPalette(c("green", "black", "red"))(n = 1000)
#heatmap.2(events.feature,col=my_palette, dendrogram = "row", trace = "none", key = 5,
#          cexCol = .8, margin = c(4,4), cexRow = .5, symbreaks = FALSE)


